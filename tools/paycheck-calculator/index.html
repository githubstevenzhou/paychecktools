<!DOCTYPE html>
<html lang="en">
<head>
  <!-- ÂºÇÊ≠•Âä†ËΩΩÂÖ¨ÂÖ± head -->
  <script>
    fetch('/templates/head.html')
      .then(r => r.text())
      .then(html => document.head.insertAdjacentHTML('beforeend', html));
  </script>

  <title>Paycheck Calculator ‚Äì PaycheckTools</title>
  <meta name="description" content="Calculate your paycheck including gross pay, taxes, and net pay.">
  <link rel="canonical" href="https://paychecktools.com/tools/paycheck-calculator/">

  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>

  <!-- Header -->
  <div id="site-header"></div>
  <script>
    fetch('/templates/header.html')
      .then(r => r.text())
      .then(html => { document.getElementById('site-header').innerHTML = html; });
  </script>

  <main class="tool-container">

    <section class="calculator">
      <h1>Paycheck Calculator</h1>

      <label>
        Hourly Wage
        <input id="wage" type="number" value="25">
      </label>

      <label>
        Hours Worked
        <input id="hours" type="number" value="40">
      </label>

      <label>
        Overtime Hours
        <input id="otHours" type="number" value="0">
      </label>

      <label>
        Federal Tax (%)
        <input id="taxFederal" type="number" value="12">
      </label>

      <label>
        State Tax (%)
        <input id="taxState" type="number" value="5">
      </label>

      <label>
        Pay Frequency
        <select id="frequency">
          <option value="weekly" selected>Weekly</option>
          <option value="biweekly">Biweekly</option>
          <option value="semimonthly">Semimonthly</option>
          <option value="monthly">Monthly</option>
        </select>
      </label>

      <button id="calculateBtn" class="primary-btn">Calculate</button>

      <div id="output" class="result-box" style="display:none;">
        <p>Gross Pay: <strong>$<span id="gross"></span></strong></p>
        <p>Total Taxes: <strong>$<span id="tax"></span></strong></p>
        <p>Net Pay: <strong>$<span id="net"></span></strong></p>
      </div>
    </section>

    <!-- Feedback Section -->
    <section id="feedback-box" class="feedback-box" style="display:none;">
      <p><strong>Was this result helpful?</strong></p>

      <div class="feedback-actions">
        <button data-vote="yes">üëç Yes</button>
        <button data-vote="no">üëé No</button>
      </div>

      <div id="no-reason-box" class="feedback-reasons" style="display:none;">
        <p>Please tell us why:</p>
        <label><input type="radio" name="no-reason" value="wrong_calculation"> Calculation seems wrong</label>
        <label><input type="radio" name="no-reason" value="unclear_result"> Result is unclear</label>
        <label><input type="radio" name="no-reason" value="missing_option"> Missing option</label>
        <label><input type="radio" name="no-reason" value="ui_confusing"> UI is confusing</label>
      </div>

      <button id="feedback-submit" class="secondary-btn">Submit Feedback</button>

      <div id="feedback-status"></div>
    </section>

  </main>

  <!-- Footer -->
  <div id="site-footer"></div>
  <script>
    fetch('/templates/footer.html')
      .then(r => r.text())
      .then(html => { document.getElementById('site-footer').innerHTML = html; });
  </script>

  <!-- Core Scripts -->
  <script src="/js/calculator-core.js"></script>

  <!-- Feedback JS ‰øÆÊ≠£Áâà -->
  <script>
  (function () {
    const box = document.getElementById("feedback-box");
    if (!box) return;

    const status = document.getElementById("feedback-status");
    const noBox = document.getElementById("no-reason-box");
    const submitBtn = document.getElementById("feedback-submit");
    const page = location.pathname;

    let selectedVote = null;
    let selectedReason = null;

    // ÊòæÁ§∫ Feedback Âå∫Âüü
    document.addEventListener("calculator:result-ready", () => {
      box.style.display = "block";
      noBox.style.display = "none";
      status.textContent = "";
      selectedVote = null;
      selectedReason = null;

      // Ê∏ÖÈô§ÊåâÈíÆÈ´ò‰∫Æ
      box.querySelectorAll("button[data-vote]").forEach(btn => btn.classList.remove("active"));
      box.querySelectorAll("input[name='no-reason']").forEach(r => r.checked = false);

      loadStats(); // ÊòæÁ§∫ÊÄªÁ•®Êï∞
    });

    // Yes / No ÁÇπÂáªÈÄªËæë
    box.querySelectorAll("button[data-vote]").forEach(btn => {
      btn.addEventListener("click", () => {
        selectedVote = btn.dataset.vote;

        // È´ò‰∫ÆÊåâÈíÆ
        box.querySelectorAll("button[data-vote]").forEach(b => b.classList.toggle("active", b === btn));

        if (selectedVote === "no") {
          noBox.style.display = "block";
        } else {
          noBox.style.display = "none";
        }

        // ‰∏çÊòæÁ§∫ÈªòËÆ§ÊèêÁ§∫ÊñáÂ≠ó
        status.textContent = "";
      });
    });

    // Submit ÁÇπÂáªÈÄªËæë
    submitBtn.addEventListener("click", async () => {
      if (!selectedVote) {
        status.textContent = "Please select Yes or No.";
        return;
      }

      if (selectedVote === "no") {
        const reason = document.querySelector("input[name='no-reason']:checked")?.value;
        if (!reason) {
          status.textContent = "Please select a reason for No.";
          return;
        }
        selectedReason = reason;
      }

      // Êèê‰∫§Âà∞ Worker
      status.textContent = "Submitting...";
      try {
        const res = await fetch("https://paychecktools-feedback.zhouqiext.workers.dev", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ page, vote: selectedVote, reason: selectedReason })
        });

        const data = await res.json();
        if (!data.success) throw new Error();

        // ÊòæÁ§∫ÊúÄÊñ∞ÁªüËÆ°
        status.textContent = `Thanks! Yes: ${data.yes} | No: ${data.no}`;
      } catch {
        status.textContent = "Failed to submit feedback.";
      }

      // Reset
      selectedVote = null;
      selectedReason = null;
      noBox.style.display = "none";
      box.querySelectorAll("button[data-vote]").forEach(b => b.classList.remove("active"));
      box.querySelectorAll("input[name='no-reason']").forEach(r => r.checked = false);
    });

    // ÊãâÂèñÊÄªÁ•®Êï∞
    async function loadStats() {
      try {
        const res = await fetch("https://paychecktools-feedback.zhouqiext.workers.dev", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ page, vote: "none" })
        });
        const data = await res.json();
        if (data.success) {
          status.textContent = `Yes: ${data.yes} | No: ${data.no}`;
        }
      } catch {}
    }
  })();
  </script>

  <!-- È°µÈù¢ËÆ°ÁÆóÈÄªËæë -->
  <script>
    document.getElementById('calculateBtn').addEventListener('click', function () {
      const result = calculatePaycheck({
        wage: Number(document.getElementById('wage').value),
        hours: Number(document.getElementById('hours').value),
        otHours: Number(document.getElementById('otHours').value),
        frequency: document.getElementById('frequency').value,
        taxes: {
          federal: Number(document.getElementById('taxFederal').value),
          state: Number(document.getElementById('taxState').value)
        }
      });

      document.getElementById('gross').innerText = result.grossPay.toFixed(2);
      document.getElementById('tax').innerText = result.breakdown.taxAmount.toFixed(2);
      document.getElementById('net').innerText = result.netPay.toFixed(2);

      document.getElementById('output').style.display = 'block';

      document.dispatchEvent(new Event('calculator:result-ready'));
    });
  </script>

</body>
</html>
